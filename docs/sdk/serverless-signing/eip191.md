import FeedbackComponent from "@site/src/pages/feedback.md";

import Tabs from '@theme/Tabs';
import TabItem from '@theme/TabItem';

# Signing within a Lit Action using EIP-191

## Overview

Lit Actions offer the ability to use [EIP-191](https://eips.ethereum.org/EIPS/eip-191?ref=blog.spruceid.com) `eth_personal_sign` to sign a message instead of a transaction or raw signature. This is done with [LitActions.ethPersonalSignMessageEcdsa](https://actions-docs.litprotocol.com/#ethpersonalsignmessageecdsa). It will prepend `"\x19Ethereum Signed Message:\n"` to the message and then hash and sign it according to the EIP-191 standard.

## Prerequisites

- Basic understanding of [Lit Actions](../serverless-signing/quick-start)

## Complete Code Example

The complete code example is available in the [Lit Developer Guides Code Repository](https://github.com/LIT-Protocol/developer-guides-code/tree/master/eip-191-signing). There you can find a Node.js and browser implementation of the code.

### Example Lit Action

The following Lit Action uses `signAndCombineEcdsa` to combine partial signatures provided by each Lit node, each of which signs a share of the `toSign` variable — this variable contains the hash of the serialized transaction. After combining these shares into a complete signature, we use `ethers.js` to serialize the transaction again, this time including the signature, to finalize it for submission.

The following Lit Action uses `ethPersonalSignMessageEcdsa` to append `"\x19Ethereum Signed Message:\n"` to the given message and then hash and sign it according to the EIP-191 standard. The `sigShare` variable is set to a boolean value of `true` if the signature was successfully generated, and `false` otherwise. The Lit Action will also return the complete signature as an object under the `sigName` key.

```jsx
const _litActionCode = async () => {
  try {
    const sigShare = await LitActions.ethPersonalSignMessageEcdsa({
      message: dataToSign,
      publicKey,
      sigName,
    });
    LitActions.setResponse({ response: sigShare });
  } catch (error) {
    LitActions.setResponse({ response: error.message });
  }
};

export const litActionCode = `(${_litActionCode.toString()})();`;
```

## Summary
This guide demonstrates how to sign an EIP-191 message using Lit Actions.

If you'd like to learn more about Lit Actions, check out the [Lit Actions SDK](https://actions-docs.litprotocol.com/), or our [Advanced Topics](https://developer.litprotocol.com/category/advanced-topics-1) section on Lit Actions.

<FeedbackComponent/>
